import time
import serial
data = [19.000 , 19.7248565877920 , 24.4646048695522 , 30.6835935590821 , 30.9160960649905 , 26.5697441624222 , 21.6797077454258 , 19.3700158248241 , 18.9982765176854 , 19.0060842343338 , 19.5206617509813 , 23.8710898677181 , 30.2883726244307 , 31.1493447193044 , 27.0514360692698 , 22.0476164987009 , 19.4746155592205 , 18.9979414227466 , 19.0102355677434 , 19.3572975531696 , 23.3036497726562 , 29.8313733772814 , 31.3410384477626 , 27.5255734460812 , 22.4408856057760 , 19.5967901887194 , 19.0009836873021 , 19.0280220213550 , 19.0949723418057 , 19.1816207610634 , 19.2731386481576 , 19.3546973721178 , 19.4114683019734 , 19.4286228067538 , 19.3913322554887 , 19.2847680172074 , 19.0941014609394 , 19.2548828680422 , 25.5146336671648 , 38.5334976029100 , 44.1730498842679 , 37.8776532027337 , 27.5826463004228 , 20.7999348217708 , 19.0405192534840 , 19.0269584642182 , 19.1352528577946 , 24.5563003703789 , 37.3559785276227 , 44.2665758287521 , 38.7436901946938 , 28.4850043108068 , 21.1670437787651 , 19.0799013133921 , 19.0245725182429 , 19.0469078163309 , 23.6702941675305 , 36.1245025915978 , 44.2504872476630 , 39.5697863601528 , 29.4142319530069 , 21.5795732551595 , 19.1393714962906 , 19.0100551756497 , 19.0469133827292 , 19.0923617025069 , 19.1397032498549 , 19.1822411396451 , 19.2132784867494 , 19.2261184060398 , 19.2140640123882 , 19.1704184206666 , 19.0884847457469 , 18.9781620177835 , 20.5617036687932 , 26.2863492258433 , 31.4309416074133 , 30.0390302066977 , 25.1638285858189 , 20.7787137176905 , 19.1545950793854 , 19.0052236380863 , 18.9875181456400 , 20.2301563413413 , 25.6452196608609 , 31.2376369198991 , 30.3739716398845 , 25.6501365946974 , 21.0632104161735 , 19.2158098349873 , 19.0025044013947 , 18.9933106562878 , 19.9430559520271 , 25.0124538490425 , 30.9760983576484 , 30.6766299038384 , 26.1377302142694 , 21.3763375223863 , 19.2908353194152 , 19.000,19.000,19.000,19.000,19.000,19.000,19.000,19.000,19.000,19.000,19.000,19.000,19.000,19.000]

try:

    portx="COM22"
    bps=9600
    timex=5
    ser=serial.Serial(portx,bps,timeout=timex)
 
    #result=ser.write(("让我康康!"+'\n').encode())
    #print("写总字节数:",result)
    
    ii = 0
    while True:
        if ii == len(data): ii=0
        
        ser.write((str(round(data[ii],2))+'\r\n').encode())
        
        ii += 1
        time.sleep(0.1)

    ser.close()#关闭串口

except Exception as e:
    print("---异常---:",e)

